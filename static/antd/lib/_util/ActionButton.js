"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_useState3=_interopRequireDefault(require("rc-util/lib/hooks/useState")),React=_interopRequireWildcard(require("react")),_button=_interopRequireDefault(require("../button")),_button2=require("../button/button");function isThenable(thing){return!(!thing||!thing.then)}var ActionButton=function ActionButton(props){var clickedRef=React.useRef(!1),ref=React.useRef(),_useState=(0,_useState3.default)(!1),_useState2=(0,_slicedToArray2.default)(_useState,2),loading=_useState2[0],setLoading=_useState2[1],close=props.close,onInternalClose=function onInternalClose(){null==close||close.apply(void 0,arguments)};React.useEffect((function(){var timeoutId;if(props.autoFocus){var $this=ref.current;timeoutId=setTimeout((function(){return $this.focus()}))}return function(){timeoutId&&clearTimeout(timeoutId)}}),[]);var type=props.type,children=props.children,prefixCls=props.prefixCls,buttonProps=props.buttonProps;return React.createElement(_button.default,(0,_extends2.default)({},(0,_button2.convertLegacyProps)(type),{onClick:function onClick(e){var actionFn=props.actionFn;if(!clickedRef.current)if(clickedRef.current=!0,actionFn){var returnValueOfOnOk;if(props.emitEvent){if(returnValueOfOnOk=actionFn(e),props.quitOnNullishReturnValue&&!isThenable(returnValueOfOnOk))return clickedRef.current=!1,void onInternalClose(e)}else if(actionFn.length)returnValueOfOnOk=actionFn(close),clickedRef.current=!1;else if(!(returnValueOfOnOk=actionFn()))return void onInternalClose();!function handlePromiseOnOk(returnValueOfOnOk){isThenable(returnValueOfOnOk)&&(setLoading(!0),returnValueOfOnOk.then((function(){setLoading(!1,!0),onInternalClose.apply(void 0,arguments),clickedRef.current=!1}),(function(e){console.error(e),setLoading(!1,!0),clickedRef.current=!1})))}(returnValueOfOnOk)}else onInternalClose()},loading,prefixCls},buttonProps,{ref}),children)},_default=ActionButton;exports.default=_default;